<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Thomas Walker">
<title>Thomas Walker: ICMB portfolio - Assignment 2.1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../hw2.2/index.html" rel="next">
<link href="../hw2/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Thomas Walker: ICMB portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../hw2.1/index.html">Assignment 2.1</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">thomas_walker_ICMB_HS24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2.1/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Assignment 2.1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2.2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Minus and Plus Curve</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Assignment 2.1</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-page-right">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas Walker </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><p>This is for the second part of the assignment.</p>
<p>So I think this phenomena gets explained easily by one sentence:</p>
<p>“Winners can keep winning while losers cant lose everything.”</p>
<p>If you get more of the share for multiple times (since there are a lot of citizens there have to be people as well that “win” multiple times in a sucession. So some people get super lucky (as someone kinda “has” to be in a pool of 5000 people playing this game 10’000 rounds long). Which means a lot of money gets concentrated for those lucky streaks. Once your poor however, you dont have many chances to get rich as most other people get poorer too, so you mostly mingle with them when you are trading.</p>
<p>My theory could be tested by putting a limit on the winning amount. Lets test that</p>
<p>We are using a trunctuated normal distribution and set the max someone can get from a distribution to the double of the mean (=200). To have a value of 200 or above is already is crazy to achieve, as my code here explains mathematically:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Function to calculate the likelihood of a value being greater than a threshold</span></span>
<span><span class="va">likelihood_above_threshold</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">threshold</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Use pnorm() to calculate the cumulative probability up to the threshold</span></span>
<span>  <span class="va">prob_below_threshold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">threshold</span>, mean <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Probability above the threshold is 1 minus the cumulative probability</span></span>
<span>  <span class="va">prob_above_threshold</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">prob_below_threshold</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">prob_above_threshold</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Example: Calculate the likelihood of wealth above 200 in a population with mean 100 and SD 20</span></span>
<span><span class="va">mean_wealth</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">sd_wealth</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">threshold</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">likelihood</span> <span class="op">&lt;-</span> <span class="fu">likelihood_above_threshold</span><span class="op">(</span><span class="va">mean_wealth</span>, <span class="va">sd_wealth</span>, <span class="va">threshold</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">likelihood</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 2.866516e-07</code></pre>
</div>
</div>
<p>installing packages truncnorm</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="va">MU</span><span class="op">/</span><span class="fl">5</span> <span class="co"># Standard deviation</span></span>
<span><span class="va">min_limit</span> <span class="op">&lt;-</span> <span class="fl">0</span>  <span class="co"># Minimum value</span></span>
<span><span class="va">max_limit</span> <span class="op">&lt;-</span> <span class="fl">200</span>  <span class="co"># Maximum value</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/olafmersmann/truncnorm">truncnorm</a></span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/truncnorm/man/dtruncnorm.html">rtruncnorm</a></span><span class="op">(</span><span class="va">N</span>, a <span class="op">=</span> <span class="va">min_limit</span>, b <span class="op">=</span> <span class="va">max_limit</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Truncated Gaussian Distribution"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Values"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now its the same game as before,creating the simulation.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  <span class="co">#adding the while loop after means that the parts have to be reshuffled at least once, else the while wouldnt get activated</span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&gt;</span> <span class="fl">200</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&gt;</span> <span class="fl">200</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>So I was right so far.</p>
<p>Lets see if this just needs more repetitions until its back to the old one, as it could just be that case. (It worked but rendering this takes super long Im sorry)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">100000</span> <span class="co">#added one more zero</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Still looks the same. So I was (probably) right. Maybe this also hints at some form of limitarianism we should implement in our political and societal system, like the (living!) philosopher and idol Ingrid Robeyns advocates for…</p>
<p>And if we even take into account how unlikely it is to even be in the top 200 based on luck, there would even be a case to lower that limit.</p>
<hr>
<p>So I think that the way numbers work, small stays small and big stays big. The distribution also looks deceptively like one half of a gaussian distribution. So how about we test that too. We let the numbers go into the negative as well while keeping our premises of splitting the money.</p>
<p>So when two actors meet, they still can’t produce more money, but they can split it in a way, where someone gets left with debts, as long as both numbers add up to each other. However, we cant let total freedom reign this, as then abnormally high numbers could be produced (-1100 and 1300 still gives the initial 200 that used to be in the pot.) Additionally, we cant just propose an absolute value as then then the poor people could just come out of poverty by trading in a way that someone gets super rich and the other super poor, which also in the model before couldn’t be done. So we have to come up with a relative value where we avoid blatant fails like that. To better illustrate my idea that Im trying to convey we can imagine how a bank would go about this: a reasonable bank would not give a very rich and a very poor person the same amount of loans. The loans are relative to the income and wealth that people have.</p>
<p>So how do we come up with a relative, reasonable number? If we look at the graph, we can see that the cap of the richest people is around 800 (?) but the last few that are continous to each other caps at around 500. This means that the first necessary step to get to be super rich is around 250-400 (as these numbers times 2 means you get to be la creme de la creme). in mathematical terms Id describe the range of the negative to the positive values like this then:</p>
<p>- Max possible value with one trade: P1+P2+(P1+P2)/2</p>
<p>- Min possible value with one trade: -(P1+P2)/2</p>
<p>And in the end, there also has to be a maximum egative value for my limiting programming skills to match it, which is going to be -999. You can NEVER have less than -999 money.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="va">MU</span><span class="op">/</span><span class="fl">5</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">population</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">+</span> <span class="fl">1000</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2000</span>, <span class="fl">2</span><span class="op">)</span> </span>
<span>  <span class="va">population</span> <span class="op">&lt;-</span> <span class="va">population</span> <span class="op">-</span> <span class="fl">1000</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span><span class="op">+</span><span class="fl">1000</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="va">part1</span><span class="op">-</span><span class="fl">1000</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span></span>
<span>  <span class="va">pcf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1000</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1000</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span><span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="va">part1</span><span class="op">-</span><span class="fl">1000</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1000</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1000</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span><span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="va">part1</span><span class="op">-</span><span class="fl">1000</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Testing smaller versions to see where the mistake is</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span></span>
<span>  <span class="va">pcf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  -4 204</code></pre>
</div>
</div>
<p>I meddled a lot, Ill try again.</p>
<p>New try</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">round_population</span>,<span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="co">#runif(1, min = -1000, max = 1000) </span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span></span>
<span>  <span class="va">pcf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -65 265</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>      </span>
<span><span class="co">#getting the people for trading</span></span>
<span><span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#making the new wealth distribution between those two</span></span>
<span><span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span><span class="co">#overwriting the old bank statement with the new one</span></span>
<span><span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Big try:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">round_population</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">x_was_negative</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">&lt;-</span><span class="fl">2</span><span class="op">*</span><span class="va">x</span></span>
<span>    <span class="va">x_was_negative</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">}</span> </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">y</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">*</span><span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span></span>
<span>  <span class="va">pcf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  </span>
<span>  <span class="va">pcf</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">pcf</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span>  <span class="co"># The remainder goes to part2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  71 129</code></pre>
</div>
</div>
<p>I think I solved it now, there were many problems with numbers that were either the same, or when it was their negative part when adding them together. I first tried to add them to the pot but if it happens that x=100 and y = -100 then the pot is zero. So then I put the absolute value in, which would be 200 again. Then it could happen that if both have 100 then the difference is 0, making them lose 200 bucks.</p>
<p>(spoiler: I didnt solve it, trying it again with the code above) The code was doing it that if I put 100 and -80 the sum is 180 so the model split than one randomly, generating money in that process.</p>
<p>Now the problem is if both numbers cancel each other out, like 80 and -80. Here I just decided that if that is the case they just dont do anything.</p>
<p>Now Im also searching for indices, cuz chatgpt told me too (so I can avoid duplicates)</p>
<p>(I removed the zeros from the normal distribution to random 1s and -1s as its super inconveniant to calculate my stuffs with zeros) maybe a project for another time.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  </span>
<span>  <span class="va">too_small</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">too_big</span> <span class="op">&lt;-</span> <span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span> <span class="op">+</span> <span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">too_big</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> </span>
<span>       <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">||</span> </span>
<span>       <span class="op">(</span><span class="va">part1</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span><span class="va">part2</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span> </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> </span>
<span>  <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="kw">while</span><span class="op">(</span><span class="va">person1</span> <span class="op">==</span> <span class="va">person2</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>        <span class="co">#getting the people for trading</span></span>
<span>        <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>        <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>ffndsafjaewklnfdsad I DID IT HELL YES IM SO HAPPY WHAT THE HELL I HAVE BEEN UPDATING THIS CODE NOW PROBS FOR 5 HOURS ONLY AND I GO TIT KFDNHSALFJDJKLÖADSLKNDFSNAKLNKLIHO</p>
<p>Danke Paul dass mer ned uf de Autobahn verunfallt sind (er isch eus heigfahre). Danke Amy fürd unterhaltig vom paul (dass er ned ihschlaft) &amp; das er überlebt (amy het ihm wasser geh). Larissa het gueti Musig gmacht. Und danke Thomas dass er eh paar stunde ned nervig gsi isch.</p>
<p>down here is my notepad</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  </span>
<span>  <span class="va">too_small</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="va">too_big</span> <span class="op">&lt;-</span> <span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">+</span><span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>  <span class="va">too_big</span><span class="op">}</span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">100</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 300</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>  <span class="co"># Ensuring no 0s and reasonable splits</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">pot</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  <span class="va">too_small</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">too_big</span> <span class="op">&lt;-</span> <span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span> <span class="op">+</span> <span class="op">(</span><span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  </span>
<span>  <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span><span class="va">part2</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span> <span class="op">+</span> <span class="fl">1</span>, <span class="op">-</span><span class="fl">100</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">pot</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Avoiding zero</span></span>
<span>    <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>    <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="co"># Ensure two different people</span></span>
<span>    <span class="kw">while</span> <span class="op">(</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">==</span> <span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Update the population</span></span>
<span>    <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">population</span><span class="op">[</span><span class="va">population</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  671 3704</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">pot</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  </span>
<span>  <span class="va">too_small</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">too_big</span> <span class="op">&lt;-</span> <span class="va">part1</span> <span class="op">+</span> <span class="va">part2</span> <span class="op">+</span> <span class="op">(</span><span class="va">part1</span><span class="op">+</span><span class="va">part2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span>  <span class="va">too_big</span></span>
<span></span>
<span> <span class="kw">while</span> <span class="op">(</span><span class="va">part1</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> <span class="va">part2</span> <span class="op">&lt;</span> <span class="va">too_small</span> <span class="op">||</span> </span>
<span>       <span class="op">(</span><span class="va">part1</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span> <span class="va">part2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">||</span> </span>
<span>       <span class="op">(</span><span class="va">part1</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span><span class="va">part2</span> <span class="op">&gt;</span> <span class="va">too_big</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="op">-</span><span class="va">pot</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Randomly assign part1</span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span> </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">50</span>,<span class="op">-</span><span class="fl">50</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 26 24</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> </span>
<span>  <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#final_population &lt;- simulation(round_population, repetitions)</span></span>
<span></span>
<span><span class="co">#final_population</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">round_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I got a new idea, for this I need a new page</p>


<!-- -->


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-page-right"><div class="nav-page nav-page-previous">
      <a href="../hw2/index.html" class="pagination-link" aria-label="Assignment 2.0">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 2.0</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../hw2.2/index.html" class="pagination-link" aria-label="Minus and Plus Curve">
        <span class="nav-page-text">Minus and Plus Curve</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb24" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Assignment 2.1"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Thomas Walker"</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>This is for the second part of the assignment.</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>So I think this phenomena gets explained easily by one sentence:</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>"Winners can keep winning while losers cant lose everything."</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>If you get more of the share for multiple times (since there are a lot of citizens there have to be people as well that "win" multiple times in a sucession. So some people get super lucky (as someone kinda "has" to be in a pool of 5000 people playing this game 10'000 rounds long). Which means a lot of money gets concentrated for those lucky streaks. Once your poor however, you dont have many chances to get rich as most other people get poorer too, so you mostly mingle with them when you are trading.</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>My theory could be tested by putting a limit on the winning amount. Lets test that</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>We are using a trunctuated normal distribution and set the max someone can get from a distribution to the double of the mean (=200). To have a value of 200 or above is already is crazy to achieve, as my code here explains mathematically:</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate the likelihood of a value being greater than a threshold</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>likelihood_above_threshold <span class="ot">&lt;-</span> <span class="cf">function</span>(mean, sd, threshold) {</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use pnorm() to calculate the cumulative probability up to the threshold</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  prob_below_threshold <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(threshold, <span class="at">mean =</span> mean, <span class="at">sd =</span> sd)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Probability above the threshold is 1 minus the cumulative probability</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  prob_above_threshold <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prob_below_threshold</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(prob_above_threshold)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Calculate the likelihood of wealth above 200 in a population with mean 100 and SD 20</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>mean_wealth <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>sd_wealth <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">likelihood_above_threshold</span>(mean_wealth, sd_wealth, threshold)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(likelihood)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>installing packages truncnorm</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population.</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> MU<span class="sc">/</span><span class="dv">5</span> <span class="co"># Standard deviation</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>min_limit <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Minimum value</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>max_limit <span class="ot">&lt;-</span> <span class="dv">200</span>  <span class="co"># Maximum value</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truncnorm)</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rtruncnorm</span>(N, <span class="at">a =</span> min_limit, <span class="at">b =</span> max_limit, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Truncated Gaussian Distribution"</span>, </span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Values"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>Now its the same game as before,creating the simulation.</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>round_population <span class="ot">&lt;-</span> <span class="fu">round</span>(population)</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population){</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(round_population), <span class="dv">2</span>)</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">#adding the while loop after means that the parts have to be reshuffled at least once, else the while wouldnt get activated</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">||</span> part2 <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)  <span class="co"># Randomly assign part1</span></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population,repetitions) {</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>repetitions) {</span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a>      selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)</span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>      <span class="co">#getting the people for trading</span></span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a>      person1 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">1</span>]]</span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a>      person2 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">2</span>]]</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>      <span class="co">#making the new wealth distribution between those two</span></span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>      new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">2</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(round_population)</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>repetitions <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>final_population <span class="ot">&lt;-</span> <span class="fu">simulation</span>(round_population, repetitions)</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(final_population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"After Simulation Grapn"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>So I was right so far.</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>Lets see if this just needs more repetitions until its back to the old one, as it could just be that case. (It worked but rendering this takes super long Im sorry)</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a><span class="in">simulation &lt;- function(round_population,repetitions) {</span></span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:repetitions) {</span></span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a><span class="in">      selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a><span class="in">      #getting the people for trading</span></span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a><span class="in">      person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a><span class="in">      person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a><span class="in">      #making the new wealth distribution between those two</span></span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a><span class="in">      new_wealth &lt;- random_split(person1, person2)</span></span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a><span class="in">      #overwriting the old bank statement with the new one</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[1]] &lt;- new_wealth[1]</span></span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[2]] &lt;- new_wealth[2]</span></span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a><span class="in">  return(round_population)</span></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-128"><a href="#cb24-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-129"><a href="#cb24-129" aria-hidden="true" tabindex="-1"></a><span class="in">repetitions &lt;- 100000 #added one more zero</span></span>
<span id="cb24-130"><a href="#cb24-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-131"><a href="#cb24-131" aria-hidden="true" tabindex="-1"></a><span class="in">final_population &lt;- simulation(round_population, repetitions)</span></span>
<span id="cb24-132"><a href="#cb24-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-133"><a href="#cb24-133" aria-hidden="true" tabindex="-1"></a><span class="in">hist(final_population, breaks = 50, main = "After Simulation Grapn", xlab = "Value", col = "skyblue")</span></span>
<span id="cb24-134"><a href="#cb24-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-135"><a href="#cb24-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-136"><a href="#cb24-136" aria-hidden="true" tabindex="-1"></a>Still looks the same. So I was (probably) right. Maybe this also hints at some form of limitarianism we should implement in our political and societal system, like the (living!) philosopher and idol Ingrid Robeyns advocates for...</span>
<span id="cb24-137"><a href="#cb24-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-138"><a href="#cb24-138" aria-hidden="true" tabindex="-1"></a>And if we even take into account how unlikely it is to even be in the top 200 based on luck, there would even be a case to lower that limit.</span>
<span id="cb24-139"><a href="#cb24-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-140"><a href="#cb24-140" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb24-141"><a href="#cb24-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-142"><a href="#cb24-142" aria-hidden="true" tabindex="-1"></a>So I think that the way numbers work, small stays small and big stays big. The distribution also looks deceptively like one half of a gaussian distribution. So how about we test that too. We let the numbers go into the negative as well while keeping our premises of splitting the money.</span>
<span id="cb24-143"><a href="#cb24-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-144"><a href="#cb24-144" aria-hidden="true" tabindex="-1"></a>So when two actors meet, they still can't produce more money, but they can split it in a way, where someone gets left with debts, as long as both numbers add up to each other. However, we cant let total freedom reign this, as then abnormally high numbers could be produced (-1100 and 1300 still gives the initial 200 that used to be in the pot.) Additionally, we cant just propose an absolute value as then then the poor people could just come out of poverty by trading in a way that someone gets super rich and the other super poor, which also in the model before couldn't be done. So we have to come up with a relative value where we avoid blatant fails like that. To better illustrate my idea that Im trying to convey we can imagine how a bank would go about this: a reasonable bank would not give a very rich and a very poor person the same amount of loans. The loans are relative to the income and wealth that people have.</span>
<span id="cb24-145"><a href="#cb24-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-146"><a href="#cb24-146" aria-hidden="true" tabindex="-1"></a>So how do we come up with a relative, reasonable number? If we look at the graph, we can see that the cap of the richest people is around 800 (?) but the last few that are continous to each other caps at around 500. This means that the first necessary step to get to be super rich is around 250-400 (as these numbers times 2 means you get to be la creme de la creme). in mathematical terms Id describe the range of the negative to the positive values like this then:</span>
<span id="cb24-147"><a href="#cb24-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-148"><a href="#cb24-148" aria-hidden="true" tabindex="-1"></a><span class="sc">\-</span> Max possible value with one trade: P1+P2+(P1+P2)/2</span>
<span id="cb24-149"><a href="#cb24-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-150"><a href="#cb24-150" aria-hidden="true" tabindex="-1"></a><span class="sc">\-</span> Min possible value with one trade: -(P1+P2)/2</span>
<span id="cb24-151"><a href="#cb24-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-152"><a href="#cb24-152" aria-hidden="true" tabindex="-1"></a>And in the end, there also has to be a maximum egative value for my limiting programming skills to match it, which is going to be -999. You can NEVER have less than -999 money.</span>
<span id="cb24-153"><a href="#cb24-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-156"><a href="#cb24-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-157"><a href="#cb24-157" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population.</span></span>
<span id="cb24-158"><a href="#cb24-158" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span id="cb24-159"><a href="#cb24-159" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> MU<span class="sc">/</span><span class="dv">5</span> <span class="co"># Standard deviation</span></span>
<span id="cb24-160"><a href="#cb24-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-161"><a href="#cb24-161" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb24-162"><a href="#cb24-162" aria-hidden="true" tabindex="-1"></a>round_population <span class="ot">&lt;-</span> <span class="fu">round</span>(population)</span>
<span id="cb24-163"><a href="#cb24-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-164"><a href="#cb24-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-165"><a href="#cb24-165" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population){</span>
<span id="cb24-166"><a href="#cb24-166" aria-hidden="true" tabindex="-1"></a>  population <span class="ot">&lt;-</span> population <span class="sc">+</span> <span class="dv">1000</span></span>
<span id="cb24-167"><a href="#cb24-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2000</span>, <span class="dv">2</span>) </span>
<span id="cb24-168"><a href="#cb24-168" aria-hidden="true" tabindex="-1"></a>  population <span class="ot">&lt;-</span> population <span class="sc">-</span> <span class="dv">1000</span></span>
<span id="cb24-169"><a href="#cb24-169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-170"><a href="#cb24-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-171"><a href="#cb24-171" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-172"><a href="#cb24-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-173"><a href="#cb24-173" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y<span class="sc">+</span><span class="dv">1000</span></span>
<span id="cb24-174"><a href="#cb24-174" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-175"><a href="#cb24-175" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-176"><a href="#cb24-176" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> part1<span class="dv">-1000</span></span>
<span id="cb24-177"><a href="#cb24-177" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-178"><a href="#cb24-178" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-179"><a href="#cb24-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-180"><a href="#cb24-180" aria-hidden="true" tabindex="-1"></a>  pcf <span class="ot">&lt;-</span> <span class="sc">-</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-181"><a href="#cb24-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-182"><a href="#cb24-182" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1000</span> <span class="sc">||</span> part2 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1000</span> <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-183"><a href="#cb24-183" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)<span class="co"># Randomly assign part1</span></span>
<span id="cb24-184"><a href="#cb24-184" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> part1<span class="dv">-1000</span></span>
<span id="cb24-185"><a href="#cb24-185" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-186"><a href="#cb24-186" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-187"><a href="#cb24-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-188"><a href="#cb24-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-189"><a href="#cb24-189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (part1 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1000</span> <span class="sc">||</span> part2 <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1000</span> <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-190"><a href="#cb24-190" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)<span class="co"># Randomly assign part1</span></span>
<span id="cb24-191"><a href="#cb24-191" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> part1<span class="dv">-1000</span></span>
<span id="cb24-192"><a href="#cb24-192" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-193"><a href="#cb24-193" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-194"><a href="#cb24-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-195"><a href="#cb24-195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-196"><a href="#cb24-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-197"><a href="#cb24-197" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population,repetitions) {</span>
<span id="cb24-198"><a href="#cb24-198" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>repetitions) {</span>
<span id="cb24-199"><a href="#cb24-199" aria-hidden="true" tabindex="-1"></a>      selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)</span>
<span id="cb24-200"><a href="#cb24-200" aria-hidden="true" tabindex="-1"></a>      <span class="co">#getting the people for trading</span></span>
<span id="cb24-201"><a href="#cb24-201" aria-hidden="true" tabindex="-1"></a>      person1 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">1</span>]]</span>
<span id="cb24-202"><a href="#cb24-202" aria-hidden="true" tabindex="-1"></a>      person2 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">2</span>]]</span>
<span id="cb24-203"><a href="#cb24-203" aria-hidden="true" tabindex="-1"></a>      <span class="co">#making the new wealth distribution between those two</span></span>
<span id="cb24-204"><a href="#cb24-204" aria-hidden="true" tabindex="-1"></a>      new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb24-205"><a href="#cb24-205" aria-hidden="true" tabindex="-1"></a>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span id="cb24-206"><a href="#cb24-206" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb24-207"><a href="#cb24-207" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">2</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb24-208"><a href="#cb24-208" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-209"><a href="#cb24-209" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-210"><a href="#cb24-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(round_population)</span>
<span id="cb24-211"><a href="#cb24-211" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-212"><a href="#cb24-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-213"><a href="#cb24-213" aria-hidden="true" tabindex="-1"></a>repetitions <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-214"><a href="#cb24-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-215"><a href="#cb24-215" aria-hidden="true" tabindex="-1"></a>final_population <span class="ot">&lt;-</span> <span class="fu">simulation</span>(round_population, repetitions)</span>
<span id="cb24-216"><a href="#cb24-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-217"><a href="#cb24-217" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(final_population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"After Simulation Grapn"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb24-218"><a href="#cb24-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-219"><a href="#cb24-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-220"><a href="#cb24-220" aria-hidden="true" tabindex="-1"></a>Testing smaller versions to see where the mistake is</span>
<span id="cb24-221"><a href="#cb24-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-224"><a href="#cb24-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-225"><a href="#cb24-225" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-226"><a href="#cb24-226" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-227"><a href="#cb24-227" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-228"><a href="#cb24-228" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-229"><a href="#cb24-229" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span><span class="dv">1000</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-230"><a href="#cb24-230" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-231"><a href="#cb24-231" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-232"><a href="#cb24-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-233"><a href="#cb24-233" aria-hidden="true" tabindex="-1"></a>  pcf <span class="ot">&lt;-</span> <span class="sc">-</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-234"><a href="#cb24-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-235"><a href="#cb24-235" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&lt;</span> pcf <span class="sc">||</span> part2 <span class="sc">&lt;</span> pcf <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-236"><a href="#cb24-236" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span><span class="dv">1000</span><span class="sc">:</span>pot, <span class="dv">1</span>)  <span class="co"># Randomly assign part1</span></span>
<span id="cb24-237"><a href="#cb24-237" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-238"><a href="#cb24-238" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-239"><a href="#cb24-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-240"><a href="#cb24-240" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-241"><a href="#cb24-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-242"><a href="#cb24-242" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb24-243"><a href="#cb24-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-244"><a href="#cb24-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-245"><a href="#cb24-245" aria-hidden="true" tabindex="-1"></a>I meddled a lot, Ill try again.</span>
<span id="cb24-246"><a href="#cb24-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-247"><a href="#cb24-247" aria-hidden="true" tabindex="-1"></a>New try</span>
<span id="cb24-248"><a href="#cb24-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-251"><a href="#cb24-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-252"><a href="#cb24-252" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population){</span>
<span id="cb24-253"><a href="#cb24-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(round_population,<span class="dv">2</span>)</span>
<span id="cb24-254"><a href="#cb24-254" aria-hidden="true" tabindex="-1"></a>  <span class="co">#runif(1, min = -1000, max = 1000) </span></span>
<span id="cb24-255"><a href="#cb24-255" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-256"><a href="#cb24-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-257"><a href="#cb24-257" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-258"><a href="#cb24-258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-259"><a href="#cb24-259" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-260"><a href="#cb24-260" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-261"><a href="#cb24-261" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span><span class="dv">1000</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-262"><a href="#cb24-262" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-263"><a href="#cb24-263" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-264"><a href="#cb24-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-265"><a href="#cb24-265" aria-hidden="true" tabindex="-1"></a>  pcf <span class="ot">&lt;-</span> <span class="sc">-</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-266"><a href="#cb24-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-267"><a href="#cb24-267" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&lt;</span> pcf <span class="sc">||</span> part2 <span class="sc">&lt;</span> pcf <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-268"><a href="#cb24-268" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span><span class="dv">1000</span><span class="sc">:</span>pot, <span class="dv">1</span>)  <span class="co"># Randomly assign part1</span></span>
<span id="cb24-269"><a href="#cb24-269" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-270"><a href="#cb24-270" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-271"><a href="#cb24-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-272"><a href="#cb24-272" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-273"><a href="#cb24-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-274"><a href="#cb24-274" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb24-275"><a href="#cb24-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-276"><a href="#cb24-276" aria-hidden="true" tabindex="-1"></a>selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)      </span>
<span id="cb24-277"><a href="#cb24-277" aria-hidden="true" tabindex="-1"></a><span class="co">#getting the people for trading</span></span>
<span id="cb24-278"><a href="#cb24-278" aria-hidden="true" tabindex="-1"></a>person1 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">1</span>]]</span>
<span id="cb24-279"><a href="#cb24-279" aria-hidden="true" tabindex="-1"></a>person2 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">2</span>]]</span>
<span id="cb24-280"><a href="#cb24-280" aria-hidden="true" tabindex="-1"></a><span class="co">#making the new wealth distribution between those two</span></span>
<span id="cb24-281"><a href="#cb24-281" aria-hidden="true" tabindex="-1"></a>new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb24-282"><a href="#cb24-282" aria-hidden="true" tabindex="-1"></a><span class="co">#overwriting the old bank statement with the new one</span></span>
<span id="cb24-283"><a href="#cb24-283" aria-hidden="true" tabindex="-1"></a>round_population[selected_people[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb24-284"><a href="#cb24-284" aria-hidden="true" tabindex="-1"></a>round_population[selected_people[<span class="dv">2</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb24-285"><a href="#cb24-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-286"><a href="#cb24-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-287"><a href="#cb24-287" aria-hidden="true" tabindex="-1"></a>Big try:</span>
<span id="cb24-288"><a href="#cb24-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-289"><a href="#cb24-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb24-290"><a href="#cb24-290" aria-hidden="true" tabindex="-1"></a><span class="in">anyone &lt;- function(round_population){</span></span>
<span id="cb24-291"><a href="#cb24-291" aria-hidden="true" tabindex="-1"></a><span class="in">  sample(round_population,2)</span></span>
<span id="cb24-292"><a href="#cb24-292" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-293"><a href="#cb24-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-294"><a href="#cb24-294" aria-hidden="true" tabindex="-1"></a><span class="in">random_split &lt;- function(x,y) {</span></span>
<span id="cb24-295"><a href="#cb24-295" aria-hidden="true" tabindex="-1"></a><span class="in">  # Sum them up</span></span>
<span id="cb24-296"><a href="#cb24-296" aria-hidden="true" tabindex="-1"></a><span class="in">  x_was_negative &lt;- FALSE</span></span>
<span id="cb24-297"><a href="#cb24-297" aria-hidden="true" tabindex="-1"></a><span class="in">  if (x&lt;0){</span></span>
<span id="cb24-298"><a href="#cb24-298" aria-hidden="true" tabindex="-1"></a><span class="in">    x&lt;-2*x</span></span>
<span id="cb24-299"><a href="#cb24-299" aria-hidden="true" tabindex="-1"></a><span class="in">    x_was_negative &lt;- TRUE</span></span>
<span id="cb24-300"><a href="#cb24-300" aria-hidden="true" tabindex="-1"></a><span class="in">  } </span></span>
<span id="cb24-301"><a href="#cb24-301" aria-hidden="true" tabindex="-1"></a><span class="in">  if (y&lt;0){</span></span>
<span id="cb24-302"><a href="#cb24-302" aria-hidden="true" tabindex="-1"></a><span class="in">    y &lt;- y*2</span></span>
<span id="cb24-303"><a href="#cb24-303" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-304"><a href="#cb24-304" aria-hidden="true" tabindex="-1"></a><span class="in">  pot &lt;- x+y</span></span>
<span id="cb24-305"><a href="#cb24-305" aria-hidden="true" tabindex="-1"></a><span class="in">  #how to share</span></span>
<span id="cb24-306"><a href="#cb24-306" aria-hidden="true" tabindex="-1"></a><span class="in">  part1 &lt;- sample(-1000:pot, 1)</span></span>
<span id="cb24-307"><a href="#cb24-307" aria-hidden="true" tabindex="-1"></a><span class="in">  #calcutlating the  split </span></span>
<span id="cb24-308"><a href="#cb24-308" aria-hidden="true" tabindex="-1"></a><span class="in">  part2 &lt;- pot - part1</span></span>
<span id="cb24-309"><a href="#cb24-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-310"><a href="#cb24-310" aria-hidden="true" tabindex="-1"></a><span class="in">  pcf &lt;- -(part1+part2)/2</span></span>
<span id="cb24-311"><a href="#cb24-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-312"><a href="#cb24-312" aria-hidden="true" tabindex="-1"></a><span class="in"> while (part1 &lt; pcf || part2 &lt; pcf || (part1 == 0 &amp;&amp; part2 == 0)) {</span></span>
<span id="cb24-313"><a href="#cb24-313" aria-hidden="true" tabindex="-1"></a><span class="in">    part1 &lt;- sample(-1000:pot, 1)  # Randomly assign part1</span></span>
<span id="cb24-314"><a href="#cb24-314" aria-hidden="true" tabindex="-1"></a><span class="in">    part2 &lt;- pot - part1  # The remainder goes to part2</span></span>
<span id="cb24-315"><a href="#cb24-315" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-316"><a href="#cb24-316" aria-hidden="true" tabindex="-1"></a><span class="in">  return(c(part1, part2))</span></span>
<span id="cb24-317"><a href="#cb24-317" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-318"><a href="#cb24-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-319"><a href="#cb24-319" aria-hidden="true" tabindex="-1"></a><span class="in">random_split(100,100)</span></span>
<span id="cb24-320"><a href="#cb24-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-321"><a href="#cb24-321" aria-hidden="true" tabindex="-1"></a><span class="in">simulation &lt;- function(round_population,repetitions) {</span></span>
<span id="cb24-322"><a href="#cb24-322" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:repetitions) {</span></span>
<span id="cb24-323"><a href="#cb24-323" aria-hidden="true" tabindex="-1"></a><span class="in">      selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-324"><a href="#cb24-324" aria-hidden="true" tabindex="-1"></a><span class="in">      #getting the people for trading</span></span>
<span id="cb24-325"><a href="#cb24-325" aria-hidden="true" tabindex="-1"></a><span class="in">      person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-326"><a href="#cb24-326" aria-hidden="true" tabindex="-1"></a><span class="in">      person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-327"><a href="#cb24-327" aria-hidden="true" tabindex="-1"></a><span class="in">      #making the new wealth distribution between those two</span></span>
<span id="cb24-328"><a href="#cb24-328" aria-hidden="true" tabindex="-1"></a><span class="in">      new_wealth &lt;- random_split(person1, person2)</span></span>
<span id="cb24-329"><a href="#cb24-329" aria-hidden="true" tabindex="-1"></a><span class="in">      #overwriting the old bank statement with the new one</span></span>
<span id="cb24-330"><a href="#cb24-330" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[1]] &lt;- new_wealth[1]</span></span>
<span id="cb24-331"><a href="#cb24-331" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[2]] &lt;- new_wealth[2]</span></span>
<span id="cb24-332"><a href="#cb24-332" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-333"><a href="#cb24-333" aria-hidden="true" tabindex="-1"></a><span class="in">  return(round_population)</span></span>
<span id="cb24-334"><a href="#cb24-334" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-335"><a href="#cb24-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-336"><a href="#cb24-336" aria-hidden="true" tabindex="-1"></a><span class="in">repetitions &lt;- 10</span></span>
<span id="cb24-337"><a href="#cb24-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-338"><a href="#cb24-338" aria-hidden="true" tabindex="-1"></a><span class="in">final_population &lt;- simulation(round_population, repetitions)</span></span>
<span id="cb24-339"><a href="#cb24-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-340"><a href="#cb24-340" aria-hidden="true" tabindex="-1"></a><span class="in">hist(final_population, breaks = 50, main = "After Simulation Grapn", xlab = "Value", col = "skyblue")</span></span>
<span id="cb24-341"><a href="#cb24-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-342"><a href="#cb24-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-345"><a href="#cb24-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-346"><a href="#cb24-346" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-347"><a href="#cb24-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-348"><a href="#cb24-348" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-349"><a href="#cb24-349" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-350"><a href="#cb24-350" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span>pot<span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-351"><a href="#cb24-351" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-352"><a href="#cb24-352" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-353"><a href="#cb24-353" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-354"><a href="#cb24-354" aria-hidden="true" tabindex="-1"></a>  pcf <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">abs</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-355"><a href="#cb24-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-356"><a href="#cb24-356" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&lt;</span> pcf <span class="sc">||</span> part2 <span class="sc">&lt;</span> pcf <span class="sc">||</span> (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>)) {</span>
<span id="cb24-357"><a href="#cb24-357" aria-hidden="true" tabindex="-1"></a>    part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span>pot<span class="sc">:</span>pot, <span class="dv">1</span>)  <span class="co"># Randomly assign part1</span></span>
<span id="cb24-358"><a href="#cb24-358" aria-hidden="true" tabindex="-1"></a>    part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1  <span class="co"># The remainder goes to part2</span></span>
<span id="cb24-359"><a href="#cb24-359" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-360"><a href="#cb24-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-361"><a href="#cb24-361" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-362"><a href="#cb24-362" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb24-363"><a href="#cb24-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-364"><a href="#cb24-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-365"><a href="#cb24-365" aria-hidden="true" tabindex="-1"></a>I think I solved it now, there were many problems with numbers that were either the same, or when it was their negative part when adding them together. I first tried to add them to the pot but if it happens that x=100 and y = -100 then the pot is zero. So then I put the absolute value in, which would be 200 again. Then it could happen that if both have 100 then the difference is 0, making them lose 200 bucks.</span>
<span id="cb24-366"><a href="#cb24-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-367"><a href="#cb24-367" aria-hidden="true" tabindex="-1"></a>(spoiler: I didnt solve it, trying it again with the code above) The code was doing it that if I put 100 and -80 the sum is 180 so the model split than one randomly, generating money in that process.</span>
<span id="cb24-368"><a href="#cb24-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-369"><a href="#cb24-369" aria-hidden="true" tabindex="-1"></a>Now the problem is if both numbers cancel each other out, like 80 and -80. Here I just decided that if that is the case they just dont do anything.</span>
<span id="cb24-370"><a href="#cb24-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-371"><a href="#cb24-371" aria-hidden="true" tabindex="-1"></a>Now Im also searching for indices, cuz chatgpt told me too (so I can avoid duplicates)</span>
<span id="cb24-372"><a href="#cb24-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-373"><a href="#cb24-373" aria-hidden="true" tabindex="-1"></a>(I removed the zeros from the normal distribution to random 1s and -1s as its super inconveniant to calculate my stuffs with zeros) maybe a project for another time.</span>
<span id="cb24-374"><a href="#cb24-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-375"><a href="#cb24-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb24-376"><a href="#cb24-376" aria-hidden="true" tabindex="-1"></a><span class="in">N  &lt;- 5000 # Population.</span></span>
<span id="cb24-377"><a href="#cb24-377" aria-hidden="true" tabindex="-1"></a><span class="in">MU &lt;- 0 # Mean of the Population</span></span>
<span id="cb24-378"><a href="#cb24-378" aria-hidden="true" tabindex="-1"></a><span class="in">std_dev &lt;- 20 # Standard deviation</span></span>
<span id="cb24-379"><a href="#cb24-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-380"><a href="#cb24-380" aria-hidden="true" tabindex="-1"></a><span class="in">population &lt;- rnorm(N, mean = MU, sd = std_dev)</span></span>
<span id="cb24-381"><a href="#cb24-381" aria-hidden="true" tabindex="-1"></a><span class="in">population[population == 0] &lt;- sample(c(-1, 1), length(population[population == 0]), replace = TRUE)</span></span>
<span id="cb24-382"><a href="#cb24-382" aria-hidden="true" tabindex="-1"></a><span class="in">round_population &lt;- round(population)</span></span>
<span id="cb24-383"><a href="#cb24-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-384"><a href="#cb24-384" aria-hidden="true" tabindex="-1"></a><span class="in">anyone &lt;- function(round_population){</span></span>
<span id="cb24-385"><a href="#cb24-385" aria-hidden="true" tabindex="-1"></a><span class="in">  sample(seq_along(round_population), 2)</span></span>
<span id="cb24-386"><a href="#cb24-386" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-387"><a href="#cb24-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-388"><a href="#cb24-388" aria-hidden="true" tabindex="-1"></a><span class="in">random_split &lt;- function(x,y){</span></span>
<span id="cb24-389"><a href="#cb24-389" aria-hidden="true" tabindex="-1"></a><span class="in">  # Sum them up</span></span>
<span id="cb24-390"><a href="#cb24-390" aria-hidden="true" tabindex="-1"></a><span class="in">  pot &lt;- x+y</span></span>
<span id="cb24-391"><a href="#cb24-391" aria-hidden="true" tabindex="-1"></a><span class="in">  #how to share</span></span>
<span id="cb24-392"><a href="#cb24-392" aria-hidden="true" tabindex="-1"></a><span class="in">  part1 &lt;- sample(-pot:pot, 1)</span></span>
<span id="cb24-393"><a href="#cb24-393" aria-hidden="true" tabindex="-1"></a><span class="in">  #calcutlating the  split </span></span>
<span id="cb24-394"><a href="#cb24-394" aria-hidden="true" tabindex="-1"></a><span class="in">  part2 &lt;- pot - part1</span></span>
<span id="cb24-395"><a href="#cb24-395" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb24-396"><a href="#cb24-396" aria-hidden="true" tabindex="-1"></a><span class="in">  too_small &lt;- -abs(part1 + part2) / 2</span></span>
<span id="cb24-397"><a href="#cb24-397" aria-hidden="true" tabindex="-1"></a><span class="in">  too_big &lt;- part1 + part2 + (part1+part2) / 2</span></span>
<span id="cb24-398"><a href="#cb24-398" aria-hidden="true" tabindex="-1"></a><span class="in">  too_big</span></span>
<span id="cb24-399"><a href="#cb24-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-400"><a href="#cb24-400" aria-hidden="true" tabindex="-1"></a><span class="in"> while (part1 &lt; too_small || part2 &lt; too_small || </span></span>
<span id="cb24-401"><a href="#cb24-401" aria-hidden="true" tabindex="-1"></a><span class="in">       (part1 == 0 &amp;&amp; part2 == 0) || </span></span>
<span id="cb24-402"><a href="#cb24-402" aria-hidden="true" tabindex="-1"></a><span class="in">       (part1 &gt; too_big) || (part2 &gt; too_big)) {</span></span>
<span id="cb24-403"><a href="#cb24-403" aria-hidden="true" tabindex="-1"></a><span class="in">  part1 &lt;- sample(-pot:pot, 1)  # Randomly assign part1</span></span>
<span id="cb24-404"><a href="#cb24-404" aria-hidden="true" tabindex="-1"></a><span class="in">  part2 &lt;- pot - part1 </span></span>
<span id="cb24-405"><a href="#cb24-405" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-406"><a href="#cb24-406" aria-hidden="true" tabindex="-1"></a><span class="in">  return(c(part1, part2))</span></span>
<span id="cb24-407"><a href="#cb24-407" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-408"><a href="#cb24-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-409"><a href="#cb24-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-410"><a href="#cb24-410" aria-hidden="true" tabindex="-1"></a><span class="in">simulation &lt;- function(round_population,repetitions) </span></span>
<span id="cb24-411"><a href="#cb24-411" aria-hidden="true" tabindex="-1"></a><span class="in">  {</span></span>
<span id="cb24-412"><a href="#cb24-412" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:repetitions) {</span></span>
<span id="cb24-413"><a href="#cb24-413" aria-hidden="true" tabindex="-1"></a><span class="in">      selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-414"><a href="#cb24-414" aria-hidden="true" tabindex="-1"></a><span class="in">      #getting the people for trading</span></span>
<span id="cb24-415"><a href="#cb24-415" aria-hidden="true" tabindex="-1"></a><span class="in">      person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-416"><a href="#cb24-416" aria-hidden="true" tabindex="-1"></a><span class="in">      person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-417"><a href="#cb24-417" aria-hidden="true" tabindex="-1"></a><span class="in">      while(person1 == person2){</span></span>
<span id="cb24-418"><a href="#cb24-418" aria-hidden="true" tabindex="-1"></a><span class="in">        selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-419"><a href="#cb24-419" aria-hidden="true" tabindex="-1"></a><span class="in">        #getting the people for trading</span></span>
<span id="cb24-420"><a href="#cb24-420" aria-hidden="true" tabindex="-1"></a><span class="in">        person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-421"><a href="#cb24-421" aria-hidden="true" tabindex="-1"></a><span class="in">        person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-422"><a href="#cb24-422" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb24-423"><a href="#cb24-423" aria-hidden="true" tabindex="-1"></a><span class="in">      #making the new wealth distribution between those two</span></span>
<span id="cb24-424"><a href="#cb24-424" aria-hidden="true" tabindex="-1"></a><span class="in">      new_wealth &lt;- random_split(person1, person2)</span></span>
<span id="cb24-425"><a href="#cb24-425" aria-hidden="true" tabindex="-1"></a><span class="in">      #overwriting the old bank statement with the new one</span></span>
<span id="cb24-426"><a href="#cb24-426" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[1]] &lt;- new_wealth[1]</span></span>
<span id="cb24-427"><a href="#cb24-427" aria-hidden="true" tabindex="-1"></a><span class="in">      round_population[selected_people[2]] &lt;- new_wealth[2]</span></span>
<span id="cb24-428"><a href="#cb24-428" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-429"><a href="#cb24-429" aria-hidden="true" tabindex="-1"></a><span class="in">  return(round_population)</span></span>
<span id="cb24-430"><a href="#cb24-430" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-431"><a href="#cb24-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-432"><a href="#cb24-432" aria-hidden="true" tabindex="-1"></a><span class="in">repetitions &lt;- 10</span></span>
<span id="cb24-433"><a href="#cb24-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-434"><a href="#cb24-434" aria-hidden="true" tabindex="-1"></a><span class="in">final_population &lt;- simulation(round_population, repetitions)</span></span>
<span id="cb24-435"><a href="#cb24-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-436"><a href="#cb24-436" aria-hidden="true" tabindex="-1"></a><span class="in">hist(final_population, breaks = 50, main = "After Simulation Grapn", xlab = "Value", col = "skyblue")</span></span>
<span id="cb24-437"><a href="#cb24-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-438"><a href="#cb24-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-439"><a href="#cb24-439" aria-hidden="true" tabindex="-1"></a>ffndsafjaewklnfdsad I DID IT HELL YES IM SO HAPPY WHAT THE HELL I HAVE BEEN UPDATING THIS CODE NOW PROBS FOR 5 HOURS ONLY AND I GO TIT KFDNHSALFJDJKLÖADSLKNDFSNAKLNKLIHO</span>
<span id="cb24-440"><a href="#cb24-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-441"><a href="#cb24-441" aria-hidden="true" tabindex="-1"></a>Danke Paul dass mer ned uf de Autobahn verunfallt sind (er isch eus heigfahre). Danke Amy fürd unterhaltig vom paul (dass er ned ihschlaft) &amp; das er überlebt (amy het ihm wasser geh). Larissa het gueti Musig gmacht. Und danke Thomas dass er eh paar stunde ned nervig gsi isch.</span>
<span id="cb24-442"><a href="#cb24-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-443"><a href="#cb24-443" aria-hidden="true" tabindex="-1"></a>down here is my notepad</span>
<span id="cb24-444"><a href="#cb24-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-447"><a href="#cb24-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-448"><a href="#cb24-448" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb24-449"><a href="#cb24-449" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-450"><a href="#cb24-450" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-451"><a href="#cb24-451" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-452"><a href="#cb24-452" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span>pot<span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-453"><a href="#cb24-453" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-454"><a href="#cb24-454" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-455"><a href="#cb24-455" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-456"><a href="#cb24-456" aria-hidden="true" tabindex="-1"></a>  too_small <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">abs</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-457"><a href="#cb24-457" aria-hidden="true" tabindex="-1"></a>  too_big <span class="ot">&lt;-</span> part1<span class="sc">+</span>part2<span class="sc">+</span>(part1<span class="sc">+</span>part2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-458"><a href="#cb24-458" aria-hidden="true" tabindex="-1"></a>  too_big}</span>
<span id="cb24-459"><a href="#cb24-459" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb24-460"><a href="#cb24-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-461"><a href="#cb24-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-462"><a href="#cb24-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-463"><a href="#cb24-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb24-464"><a href="#cb24-464" aria-hidden="true" tabindex="-1"></a><span class="in">N  &lt;- 5000 # Population.</span></span>
<span id="cb24-465"><a href="#cb24-465" aria-hidden="true" tabindex="-1"></a><span class="in">MU &lt;- 0 # Mean of the Population</span></span>
<span id="cb24-466"><a href="#cb24-466" aria-hidden="true" tabindex="-1"></a><span class="in">std_dev &lt;- 20 # Standard deviation</span></span>
<span id="cb24-467"><a href="#cb24-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-468"><a href="#cb24-468" aria-hidden="true" tabindex="-1"></a><span class="in">population &lt;- rnorm(N, mean = MU, sd = std_dev)</span></span>
<span id="cb24-469"><a href="#cb24-469" aria-hidden="true" tabindex="-1"></a><span class="in">population[population == 0] &lt;- sample(c(-1, 1), length(population[population == 0]), replace = TRUE)</span></span>
<span id="cb24-470"><a href="#cb24-470" aria-hidden="true" tabindex="-1"></a><span class="in">round_population &lt;- round(population)</span></span>
<span id="cb24-471"><a href="#cb24-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-472"><a href="#cb24-472" aria-hidden="true" tabindex="-1"></a><span class="in">anyone &lt;- function(round_population){</span></span>
<span id="cb24-473"><a href="#cb24-473" aria-hidden="true" tabindex="-1"></a><span class="in">  sample(seq_along(round_population), 2)</span></span>
<span id="cb24-474"><a href="#cb24-474" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-475"><a href="#cb24-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-476"><a href="#cb24-476" aria-hidden="true" tabindex="-1"></a><span class="in">random_split &lt;- function(x, y) {</span></span>
<span id="cb24-477"><a href="#cb24-477" aria-hidden="true" tabindex="-1"></a><span class="in">  pot &lt;- x + y</span></span>
<span id="cb24-478"><a href="#cb24-478" aria-hidden="true" tabindex="-1"></a><span class="in">  # Ensuring no 0s and reasonable splits</span></span>
<span id="cb24-479"><a href="#cb24-479" aria-hidden="true" tabindex="-1"></a><span class="in">  part1 &lt;- sample(max(-pot + 1, -100):min(pot - 1, 100), 1)</span></span>
<span id="cb24-480"><a href="#cb24-480" aria-hidden="true" tabindex="-1"></a><span class="in">  part2 &lt;- pot - part1</span></span>
<span id="cb24-481"><a href="#cb24-481" aria-hidden="true" tabindex="-1"></a><span class="in">  too_small &lt;- -abs(part1 + part2) / 2</span></span>
<span id="cb24-482"><a href="#cb24-482" aria-hidden="true" tabindex="-1"></a><span class="in">  too_big &lt;- part1 + part2 + (part1 + part2) / 2</span></span>
<span id="cb24-483"><a href="#cb24-483" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb24-484"><a href="#cb24-484" aria-hidden="true" tabindex="-1"></a><span class="in">  while (part1 &lt; too_small || part2 &lt; too_small || (part1 &gt; too_big) || (part2 &gt; too_big)) {</span></span>
<span id="cb24-485"><a href="#cb24-485" aria-hidden="true" tabindex="-1"></a><span class="in">    part1 &lt;- sample(max(-pot + 1, -100):min(pot - 1, 100), 1)  # Avoiding zero</span></span>
<span id="cb24-486"><a href="#cb24-486" aria-hidden="true" tabindex="-1"></a><span class="in">    part2 &lt;- pot - part1</span></span>
<span id="cb24-487"><a href="#cb24-487" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-488"><a href="#cb24-488" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb24-489"><a href="#cb24-489" aria-hidden="true" tabindex="-1"></a><span class="in">  return(c(part1, part2))</span></span>
<span id="cb24-490"><a href="#cb24-490" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-491"><a href="#cb24-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-492"><a href="#cb24-492" aria-hidden="true" tabindex="-1"></a><span class="in">simulation &lt;- function(round_population, repetitions) {</span></span>
<span id="cb24-493"><a href="#cb24-493" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:repetitions) {</span></span>
<span id="cb24-494"><a href="#cb24-494" aria-hidden="true" tabindex="-1"></a><span class="in">    selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-495"><a href="#cb24-495" aria-hidden="true" tabindex="-1"></a><span class="in">    person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-496"><a href="#cb24-496" aria-hidden="true" tabindex="-1"></a><span class="in">    person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-497"><a href="#cb24-497" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-498"><a href="#cb24-498" aria-hidden="true" tabindex="-1"></a><span class="in">    # Ensure two different people</span></span>
<span id="cb24-499"><a href="#cb24-499" aria-hidden="true" tabindex="-1"></a><span class="in">    while (selected_people[1] == selected_people[2]) {</span></span>
<span id="cb24-500"><a href="#cb24-500" aria-hidden="true" tabindex="-1"></a><span class="in">      selected_people &lt;- anyone(round_population)</span></span>
<span id="cb24-501"><a href="#cb24-501" aria-hidden="true" tabindex="-1"></a><span class="in">      person1 &lt;- round_population[selected_people[1]]</span></span>
<span id="cb24-502"><a href="#cb24-502" aria-hidden="true" tabindex="-1"></a><span class="in">      person2 &lt;- round_population[selected_people[2]]</span></span>
<span id="cb24-503"><a href="#cb24-503" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb24-504"><a href="#cb24-504" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-505"><a href="#cb24-505" aria-hidden="true" tabindex="-1"></a><span class="in">    new_wealth &lt;- random_split(person1, person2)</span></span>
<span id="cb24-506"><a href="#cb24-506" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb24-507"><a href="#cb24-507" aria-hidden="true" tabindex="-1"></a><span class="in">    # Update the population</span></span>
<span id="cb24-508"><a href="#cb24-508" aria-hidden="true" tabindex="-1"></a><span class="in">    round_population[selected_people[1]] &lt;- new_wealth[1]</span></span>
<span id="cb24-509"><a href="#cb24-509" aria-hidden="true" tabindex="-1"></a><span class="in">    round_population[selected_people[2]] &lt;- new_wealth[2]</span></span>
<span id="cb24-510"><a href="#cb24-510" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb24-511"><a href="#cb24-511" aria-hidden="true" tabindex="-1"></a><span class="in">  return(round_population)</span></span>
<span id="cb24-512"><a href="#cb24-512" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb24-513"><a href="#cb24-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-514"><a href="#cb24-514" aria-hidden="true" tabindex="-1"></a><span class="in">repetitions &lt;- 10</span></span>
<span id="cb24-515"><a href="#cb24-515" aria-hidden="true" tabindex="-1"></a><span class="in">final_population &lt;- simulation(round_population, repetitions)</span></span>
<span id="cb24-516"><a href="#cb24-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-517"><a href="#cb24-517" aria-hidden="true" tabindex="-1"></a><span class="in">hist(final_population, breaks = 50, main = "After Simulation Grapn", xlab = "Value", col = "skyblue")</span></span>
<span id="cb24-518"><a href="#cb24-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-519"><a href="#cb24-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-522"><a href="#cb24-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb24-523"><a href="#cb24-523" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population.</span></span>
<span id="cb24-524"><a href="#cb24-524" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Mean of the Population</span></span>
<span id="cb24-525"><a href="#cb24-525" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># Standard deviation</span></span>
<span id="cb24-526"><a href="#cb24-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-527"><a href="#cb24-527" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb24-528"><a href="#cb24-528" aria-hidden="true" tabindex="-1"></a>population[population <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="fu">length</span>(population[population <span class="sc">==</span> <span class="dv">0</span>]), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-529"><a href="#cb24-529" aria-hidden="true" tabindex="-1"></a>round_population <span class="ot">&lt;-</span> <span class="fu">round</span>(population)</span>
<span id="cb24-530"><a href="#cb24-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-531"><a href="#cb24-531" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population){</span>
<span id="cb24-532"><a href="#cb24-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="fu">seq_along</span>(round_population), <span class="dv">2</span>)</span>
<span id="cb24-533"><a href="#cb24-533" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-534"><a href="#cb24-534" aria-hidden="true" tabindex="-1"></a><span class="fu">anyone</span>(round_population)</span>
<span id="cb24-535"><a href="#cb24-535" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb24-536"><a href="#cb24-536" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb24-537"><a href="#cb24-537" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb24-538"><a href="#cb24-538" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(pot <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb24-539"><a href="#cb24-539" aria-hidden="true" tabindex="-1"></a>    pot <span class="ot">&lt;-</span> x</span>
<span id="cb24-540"><a href="#cb24-540" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-541"><a href="#cb24-541" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb24-542"><a href="#cb24-542" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span>pot<span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb24-543"><a href="#cb24-543" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb24-544"><a href="#cb24-544" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb24-545"><a href="#cb24-545" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-546"><a href="#cb24-546" aria-hidden="true" tabindex="-1"></a>  too_small <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">abs</span>(part1 <span class="sc">+</span> part2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb24-547"><a href="#cb24-547" aria-hidden="true" tabindex="-1"></a>  too_big <span class="ot">&lt;-</span> part1 <span class="sc">+</span> part2 <span class="sc">+</span> (part1<span class="sc">+</span>part2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb24-548"><a href="#cb24-548" aria-hidden="true" tabindex="-1"></a>  too_big</span>
<span id="cb24-549"><a href="#cb24-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-550"><a href="#cb24-550" aria-hidden="true" tabindex="-1"></a> <span class="cf">while</span> (part1 <span class="sc">&lt;</span> too_small <span class="sc">||</span> part2 <span class="sc">&lt;</span> too_small <span class="sc">||</span> </span>
<span id="cb24-551"><a href="#cb24-551" aria-hidden="true" tabindex="-1"></a>       (part1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> part2 <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">||</span> </span>
<span id="cb24-552"><a href="#cb24-552" aria-hidden="true" tabindex="-1"></a>       (part1 <span class="sc">&gt;</span> too_big) <span class="sc">||</span> (part2 <span class="sc">&gt;</span> too_big)) {</span>
<span id="cb24-553"><a href="#cb24-553" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="sc">-</span>pot<span class="sc">:</span>pot, <span class="dv">1</span>)  <span class="co"># Randomly assign part1</span></span>
<span id="cb24-554"><a href="#cb24-554" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1 </span>
<span id="cb24-555"><a href="#cb24-555" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-556"><a href="#cb24-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb24-557"><a href="#cb24-557" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-558"><a href="#cb24-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-559"><a href="#cb24-559" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">50</span>,<span class="sc">-</span><span class="dv">50</span>)</span>
<span id="cb24-560"><a href="#cb24-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-561"><a href="#cb24-561" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) </span>
<span id="cb24-562"><a href="#cb24-562" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb24-563"><a href="#cb24-563" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>y) {</span>
<span id="cb24-564"><a href="#cb24-564" aria-hidden="true" tabindex="-1"></a>      selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(x)</span>
<span id="cb24-565"><a href="#cb24-565" aria-hidden="true" tabindex="-1"></a>      <span class="co">#getting the people for trading</span></span>
<span id="cb24-566"><a href="#cb24-566" aria-hidden="true" tabindex="-1"></a>      person1 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">1</span>]]</span>
<span id="cb24-567"><a href="#cb24-567" aria-hidden="true" tabindex="-1"></a>      person2 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">2</span>]]</span>
<span id="cb24-568"><a href="#cb24-568" aria-hidden="true" tabindex="-1"></a>      <span class="co">#making the new wealth distribution between those two</span></span>
<span id="cb24-569"><a href="#cb24-569" aria-hidden="true" tabindex="-1"></a>      new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb24-570"><a href="#cb24-570" aria-hidden="true" tabindex="-1"></a>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span id="cb24-571"><a href="#cb24-571" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb24-572"><a href="#cb24-572" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">2</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb24-573"><a href="#cb24-573" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-574"><a href="#cb24-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(round_population)</span>
<span id="cb24-575"><a href="#cb24-575" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-576"><a href="#cb24-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-577"><a href="#cb24-577" aria-hidden="true" tabindex="-1"></a>repetitions <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb24-578"><a href="#cb24-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-579"><a href="#cb24-579" aria-hidden="true" tabindex="-1"></a><span class="co">#final_population &lt;- simulation(round_population, repetitions)</span></span>
<span id="cb24-580"><a href="#cb24-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-581"><a href="#cb24-581" aria-hidden="true" tabindex="-1"></a><span class="co">#final_population</span></span>
<span id="cb24-582"><a href="#cb24-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-583"><a href="#cb24-583" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(round_population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"After Simulation Grapn"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb24-584"><a href="#cb24-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb24-585"><a href="#cb24-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-586"><a href="#cb24-586" aria-hidden="true" tabindex="-1"></a>I got a new idea, for this I need a new page</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>