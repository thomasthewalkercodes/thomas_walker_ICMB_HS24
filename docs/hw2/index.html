<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Thomas Walker">
<title>Thomas Walker: ICMB portfolio - Assignment 2.0</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../hw2.1/index.html" rel="next">
<link href="../hw1/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Thomas Walker: ICMB portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../hw2/index.html">Assignment 2.0</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">thomas_walker_ICMB_HS24</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Assignment 2.0</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2.1/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2.1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw2.2/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Minus and Plus Curve</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Assignment 2.0</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-page-right">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas Walker </p>
          </div>
  </div>
    
  
    
  </div>
  


</header><p>This is my try to replicate the simulation according to the assignment of replicating this simulation found <a href="https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container">here</a>.</p>
<p>Since the import random code didnt work out, Ill rewrite the code with the rnorm code, that should give us the same curve. Also creating a histogram for us to see.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Random Gaussian Distribution"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now we are computing the gini coefficient. (chatgpt assisted)</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">gini</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sort the population</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Number of elements</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Calculate the Gini coefficient</span></span>
<span>  <span class="va">numer</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="va">y</span><span class="op">)</span></span>
<span>  <span class="va">denom</span> <span class="op">&lt;-</span> <span class="va">n</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Return the Gini coefficient</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="op">(</span><span class="va">numer</span> <span class="op">/</span> <span class="va">denom</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now, lets put my population into the gini coefficient.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0847681</code></pre>
</div>
</div>
<p>Here is me running my simulation multiple times to see if this was a fluke:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">population1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">population5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gini</span><span class="op">(</span><span class="va">population1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08331847</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08309262</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08386314</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08499821</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08513986</code></pre>
</div>
</div>
<p>We see that its always around 0.084. Which is a bit weird since in the simulation of the document Im reading puts the gini coeff at 0.11. Since the error is pretty consistent, I suspect an error in my code. I read through the parameters of the gaussian distribution and saw that the put a small formula into the std_dev part: MU/5. Which is std_dev = 20 but I used std_dev = 15.</p>
<p>Lets change that and see whats up</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev2</span> <span class="op">&lt;-</span> <span class="va">MU</span><span class="op">/</span><span class="fl">5</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Random Gaussian Distribution"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The histogram already looks a bit flatter, which should imply a higher gini coefficient as its more unequal.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1117662</code></pre>
</div>
</div>
<p>Perfect. Now lets test again if its a fluke.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">population1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span><span class="va">population2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span><span class="va">population3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span><span class="va">population4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span><span class="va">population5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gini</span><span class="op">(</span><span class="va">population1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1118576</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1132838</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1122562</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1120957</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">gini</span><span class="op">(</span><span class="va">population5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1121591</code></pre>
</div>
</div>
<p>Now in the end, Ill do the histogram prettier.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Random Gaussian Distribution"</span>, xlab <span class="op">=</span> <span class="st">"wealth"</span>, ylab <span class="op">=</span> <span class="st">"count"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span>
<span><span class="va">gini_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">gini</span><span class="op">(</span><span class="va">population</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">150</span>, y <span class="op">=</span> <span class="fl">400</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">gini_text</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"skyblue"</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This suffices.</p>
<p>Now Ill write the function of the money splitting. To be honest, I have never written a function myself but I can use the gini function as a blueprint.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span>, min<span class="op">=</span><span class="fl">0</span>, max<span class="op">=</span><span class="va">pot</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  <span class="co"># Return the Gini coefficient</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lets run this bad boy</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_split</span><span class="op">(</span><span class="fl">30</span>,<span class="fl">70</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 67.14333 32.85667</code></pre>
</div>
</div>
<p>Okay so I dont like how it splits the money into so many small parts. This doesnt make sense as we in real life dont do that either. If we want bigger numbers, Ill just up the amount of money people trade with. Else why did we put the number on 100 if we are taking in numbers in the millions??? Exactly.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  </span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  </span>
<span>  <span class="co"># Return the Gini coefficient</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">random_split</span><span class="op">(</span><span class="fl">70</span>,<span class="fl">30</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 15 85</code></pre>
</div>
</div>
<p>better.</p>
<p>Now, like in the guide, lets see if we can pick two random citiziens of our population.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">N</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">anyone</span><span class="op">(</span><span class="va">N</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1]  661 3002</code></pre>
</div>
</div>
<p>Now lets officially start with simulating whueee :)))</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"simulate &lt;- function(N, repetitions){</span></span>
<span><span class="st">  history &lt;- list()</span></span>
<span><span class="st">  #so that the first entry is the population we started with</span></span>
<span><span class="st">  history[[1]] &lt;- N</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  for (t in 1:repetitions){</span></span>
<span><span class="st">    selected_people &lt;- anyone(N)</span></span>
<span><span class="st">    #getting the people for trading</span></span>
<span><span class="st">    person1 &lt;- selected_people[1]</span></span>
<span><span class="st">    person2 &lt;- selected_people[2]</span></span>
<span><span class="st">    #getting them the amount what they traded</span></span>
<span><span class="st">    new_wealth &lt;- random_split(person1, person2)</span></span>
<span><span class="st">    #Updating their money</span></span>
<span><span class="st">    N[N == person1] &lt;- new_wealth[1]</span></span>
<span><span class="st">    N[N == person2] &lt;- new_wealth[2]</span></span>
<span><span class="st">    #Record the current state of the population</span></span>
<span><span class="st">    history[[t+1]] &lt;- population</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  return(history)</span></span>
<span><span class="st">}</span></span>
<span><span class="st"></span></span>
<span><span class="st">repetitions &lt;-1</span></span>
<span><span class="st"></span></span>
<span><span class="st">simulate(population, repetitions)"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "simulate &lt;- function(N, repetitions){\n  history &lt;- list()\n  #so that the first entry is the population we started with\n  history[[1]] &lt;- N\n  \n  for (t in 1:repetitions){\n    selected_people &lt;- anyone(N)\n    #getting the people for trading\n    person1 &lt;- selected_people[1]\n    person2 &lt;- selected_people[2]\n    #getting them the amount what they traded\n    new_wealth &lt;- random_split(person1, person2)\n    #Updating their money\n    N[N == person1] &lt;- new_wealth[1]\n    N[N == person2] &lt;- new_wealth[2]\n    #Record the current state of the population\n    history[[t+1]] &lt;- population\n  }\n  \n  return(history)\n}\n\nrepetitions &lt;-1\n\nsimulate(population, repetitions)"</code></pre>
</div>
</div>
<p>This next code block is to test some small parts of the code above and see where the problem is.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>    <span class="co">#getting the people for trading</span></span>
<span>    <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>    </span>
<span><span class="va">person1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3337</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">person2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 307</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 1790 1854</code></pre>
</div>
</div>
<p>I have run into several problems and started solving them in the editor. I think its better if I describe some procesess I have been doing though. So I still get decimals in the gaussian distribution, which I dont want. So Ill change that.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">round_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"Random Gaussian Distribution"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Again, some shenanigangs.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">person1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3337</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">person2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 307</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="co">#getting the people for trading</span></span>
<span><span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">person1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3529</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">person2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 598</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>    <span class="co">#getting them the amount what they traded</span></span>
<span><span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>    <span class="co">#Updating their money</span></span>
<span><span class="va">round_population</span><span class="op">[</span><span class="va">round_population</span> <span class="op">==</span> <span class="va">person1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">round_population</span><span class="op">[</span><span class="va">round_population</span> <span class="op">==</span> <span class="va">person2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">person1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 3529</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">person2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 598</code></pre>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span>    <span class="co">#Record the current state of the population</span></span>
<span>    <span class="co">#history[[t+1]] &lt;- round_population</span></span>
<span>  <span class="co">#}</span></span>
<span>  </span>
<span></span>
<span></span>
<span><span class="co">#simulate(round_population, repetitions)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>all in one thing:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">N</span>  <span class="op">&lt;-</span> <span class="fl">5000</span> <span class="co"># Population.</span></span>
<span><span class="va">MU</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># Mean of the Population</span></span>
<span><span class="va">std_dev</span> <span class="op">&lt;-</span> <span class="va">MU</span><span class="op">/</span><span class="fl">5</span> <span class="co"># Standard deviation</span></span>
<span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>, mean <span class="op">=</span> <span class="va">MU</span>, sd <span class="op">=</span> <span class="va">std_dev</span><span class="op">)</span></span>
<span><span class="va">round_population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">anyone</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">random_split</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Sum them up</span></span>
<span>  <span class="va">pot</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">+</span><span class="va">y</span></span>
<span>  <span class="co">#how to share</span></span>
<span>  <span class="va">part1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">pot</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#calcutlating the  split </span></span>
<span>  <span class="va">part2</span> <span class="op">&lt;-</span> <span class="va">pot</span> <span class="op">-</span> <span class="va">part1</span></span>
<span>  <span class="co"># Return the Gini coefficient</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">part1</span>, <span class="va">part2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">simulation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">round_population</span>,<span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">repetitions</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">selected_people</span> <span class="op">&lt;-</span> <span class="fu">anyone</span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span>      <span class="co">#getting the people for trading</span></span>
<span>      <span class="va">person1</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="va">person2</span> <span class="op">&lt;-</span> <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="co">#making the new wealth distribution between those two</span></span>
<span>      <span class="va">new_wealth</span> <span class="op">&lt;-</span> <span class="fu">random_split</span><span class="op">(</span><span class="va">person1</span>, <span class="va">person2</span><span class="op">)</span></span>
<span>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">round_population</span><span class="op">[</span><span class="va">selected_people</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_wealth</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      </span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">round_population</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">repetitions</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="va">final_population</span> <span class="op">&lt;-</span> <span class="fu">simulation</span><span class="op">(</span><span class="va">round_population</span>, <span class="va">repetitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">final_population</span>, breaks <span class="op">=</span> <span class="fl">50</span>, main <span class="op">=</span> <span class="st">"After Simulation Grapn"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This IS CORRECT I WANT TO SCREAM OH MY GOD I CHANGED SO MUCH AND NOW I GET IT YAAAs.</p>
<p>I also noticed that only starting at like 10’000 simulations we get this distribution, before that we dont. (Maybe Ill implement this in this website we will see)</p>


<!-- -->


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-page-right"><div class="nav-page nav-page-previous">
      <a href="../hw1/index.html" class="pagination-link" aria-label="Assignment 1.0">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 1.0</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../hw2.1/index.html" class="pagination-link" aria-label="Assignment 2.1">
        <span class="nav-page-text">Assignment 2.1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb59" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Assignment 2.0"</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Thomas Walker"</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>This is my try to replicate the simulation according to the assignment of replicating this simulation found <span class="co">[</span><span class="ot">here</span><span class="co">](https://github.com/norvig/pytudes/blob/main/ipynb/Economics.ipynb#js-repo-pjax-container)</span>.</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>Since the import random code didnt work out, Ill rewrite the code with the rnorm code, that should give us the same curve. Also creating a histogram for us to see.</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co"># Standard deviation</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Random Gaussian Distribution"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>Now we are computing the gini coefficient. (chatgpt assisted)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>gini <span class="ot">&lt;-</span> <span class="cf">function</span>(y) {</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sort the population</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(y)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Number of elements</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the Gini coefficient</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>  numer <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>((<span class="dv">1</span><span class="sc">:</span>n) <span class="sc">*</span> y)</span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  denom <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">sum</span>(y)</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the Gini coefficient</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((numer <span class="sc">/</span> denom) <span class="sc">-</span> (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> n)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>Now, lets put my population into the gini coefficient.</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population)</span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true" tabindex="-1"></a>Here is me running my simulation multiple times to see if this was a fluke:</span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true" tabindex="-1"></a>population1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true" tabindex="-1"></a>population2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true" tabindex="-1"></a>population3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true" tabindex="-1"></a>population4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true" tabindex="-1"></a>population5 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population1)</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population2)</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population3)</span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population4)</span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population5)</span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true" tabindex="-1"></a>We see that its always around 0.084. Which is a bit weird since in the simulation of the document Im reading puts the gini coeff at 0.11. Since the error is pretty consistent, I suspect an error in my code. I read through the parameters of the gaussian distribution and saw that the put a small formula into the std_dev part: MU/5. Which is std_dev = 20 but I used std_dev = 15.</span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true" tabindex="-1"></a>Lets change that and see whats up</span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population</span></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="fl">100.</span> <span class="co"># Mean of the Population</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true" tabindex="-1"></a>std_dev2 <span class="ot">&lt;-</span> MU<span class="sc">/</span><span class="dv">5</span> <span class="co"># Standard deviation</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Random Gaussian Distribution"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true" tabindex="-1"></a>The histogram already looks a bit flatter, which should imply a higher gini coefficient as its more unequal.</span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population)</span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true" tabindex="-1"></a>Perfect. Now lets test again if its a fluke.</span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true" tabindex="-1"></a>population1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true" tabindex="-1"></a>population2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true" tabindex="-1"></a>population3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true" tabindex="-1"></a>population4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true" tabindex="-1"></a>population5 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev2)</span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population1)</span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population2)</span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population3)</span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population4)</span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true" tabindex="-1"></a><span class="fu">gini</span>(population5)</span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true" tabindex="-1"></a>Now in the end, Ill do the histogram prettier.</span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Random Gaussian Distribution"</span>, <span class="at">xlab =</span> <span class="st">"wealth"</span>, <span class="at">ylab =</span> <span class="st">"count"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true" tabindex="-1"></a>gini_text <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">gini</span>(population),<span class="dv">4</span>)</span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">150</span>, <span class="at">y =</span> <span class="dv">400</span>, <span class="at">labels =</span> <span class="fu">paste</span>(gini_text), <span class="at">col =</span> <span class="st">"skyblue"</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true" tabindex="-1"></a>This suffices.</span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true" tabindex="-1"></a>Now Ill write the function of the money splitting. To be honest, I have never written a function myself but I can use the gini function as a blueprint.</span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span>pot)</span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the Gini coefficient</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true" tabindex="-1"></a>Lets run this bad boy</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">30</span>,<span class="dv">70</span>)</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true" tabindex="-1"></a>Okay so I dont like how it splits the money into so many small parts. This doesnt make sense as we in real life dont do that either. If we want bigger numbers, Ill just up the amount of money people trade with. Else why did we put the number on 100 if we are taking in numbers in the millions??? Exactly.</span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the Gini coefficient</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(<span class="dv">70</span>,<span class="dv">30</span>)</span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true" tabindex="-1"></a>better.</span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true" tabindex="-1"></a>Now, like in the guide, lets see if we can pick two random citiziens of our population.</span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>N, <span class="dv">2</span>)</span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true" tabindex="-1"></a><span class="fu">anyone</span>(N) </span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-184"><a href="#cb59-184" aria-hidden="true" tabindex="-1"></a>Now lets officially start with simulating whueee :)))</span>
<span id="cb59-185"><a href="#cb59-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-188"><a href="#cb59-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-189"><a href="#cb59-189" aria-hidden="true" tabindex="-1"></a><span class="st">"simulate &lt;- function(N, repetitions){</span></span>
<span id="cb59-190"><a href="#cb59-190" aria-hidden="true" tabindex="-1"></a><span class="st">  history &lt;- list()</span></span>
<span id="cb59-191"><a href="#cb59-191" aria-hidden="true" tabindex="-1"></a><span class="st">  #so that the first entry is the population we started with</span></span>
<span id="cb59-192"><a href="#cb59-192" aria-hidden="true" tabindex="-1"></a><span class="st">  history[[1]] &lt;- N</span></span>
<span id="cb59-193"><a href="#cb59-193" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb59-194"><a href="#cb59-194" aria-hidden="true" tabindex="-1"></a><span class="st">  for (t in 1:repetitions){</span></span>
<span id="cb59-195"><a href="#cb59-195" aria-hidden="true" tabindex="-1"></a><span class="st">    selected_people &lt;- anyone(N)</span></span>
<span id="cb59-196"><a href="#cb59-196" aria-hidden="true" tabindex="-1"></a><span class="st">    #getting the people for trading</span></span>
<span id="cb59-197"><a href="#cb59-197" aria-hidden="true" tabindex="-1"></a><span class="st">    person1 &lt;- selected_people[1]</span></span>
<span id="cb59-198"><a href="#cb59-198" aria-hidden="true" tabindex="-1"></a><span class="st">    person2 &lt;- selected_people[2]</span></span>
<span id="cb59-199"><a href="#cb59-199" aria-hidden="true" tabindex="-1"></a><span class="st">    #getting them the amount what they traded</span></span>
<span id="cb59-200"><a href="#cb59-200" aria-hidden="true" tabindex="-1"></a><span class="st">    new_wealth &lt;- random_split(person1, person2)</span></span>
<span id="cb59-201"><a href="#cb59-201" aria-hidden="true" tabindex="-1"></a><span class="st">    #Updating their money</span></span>
<span id="cb59-202"><a href="#cb59-202" aria-hidden="true" tabindex="-1"></a><span class="st">    N[N == person1] &lt;- new_wealth[1]</span></span>
<span id="cb59-203"><a href="#cb59-203" aria-hidden="true" tabindex="-1"></a><span class="st">    N[N == person2] &lt;- new_wealth[2]</span></span>
<span id="cb59-204"><a href="#cb59-204" aria-hidden="true" tabindex="-1"></a><span class="st">    #Record the current state of the population</span></span>
<span id="cb59-205"><a href="#cb59-205" aria-hidden="true" tabindex="-1"></a><span class="st">    history[[t+1]] &lt;- population</span></span>
<span id="cb59-206"><a href="#cb59-206" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb59-207"><a href="#cb59-207" aria-hidden="true" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb59-208"><a href="#cb59-208" aria-hidden="true" tabindex="-1"></a><span class="st">  return(history)</span></span>
<span id="cb59-209"><a href="#cb59-209" aria-hidden="true" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb59-210"><a href="#cb59-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-211"><a href="#cb59-211" aria-hidden="true" tabindex="-1"></a><span class="st">repetitions &lt;-1</span></span>
<span id="cb59-212"><a href="#cb59-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-213"><a href="#cb59-213" aria-hidden="true" tabindex="-1"></a><span class="st">simulate(population, repetitions)"</span></span>
<span id="cb59-214"><a href="#cb59-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-215"><a href="#cb59-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-216"><a href="#cb59-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-217"><a href="#cb59-217" aria-hidden="true" tabindex="-1"></a>This next code block is to test some small parts of the code above and see where the problem is.</span>
<span id="cb59-218"><a href="#cb59-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-221"><a href="#cb59-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-222"><a href="#cb59-222" aria-hidden="true" tabindex="-1"></a>selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)</span>
<span id="cb59-223"><a href="#cb59-223" aria-hidden="true" tabindex="-1"></a>    <span class="co">#getting the people for trading</span></span>
<span id="cb59-224"><a href="#cb59-224" aria-hidden="true" tabindex="-1"></a>    person1 <span class="ot">&lt;-</span> selected_people[<span class="dv">1</span>]</span>
<span id="cb59-225"><a href="#cb59-225" aria-hidden="true" tabindex="-1"></a>    person2 <span class="ot">&lt;-</span> selected_people[<span class="dv">2</span>]</span>
<span id="cb59-226"><a href="#cb59-226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb59-227"><a href="#cb59-227" aria-hidden="true" tabindex="-1"></a>person1</span>
<span id="cb59-228"><a href="#cb59-228" aria-hidden="true" tabindex="-1"></a>person2</span>
<span id="cb59-229"><a href="#cb59-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-230"><a href="#cb59-230" aria-hidden="true" tabindex="-1"></a><span class="fu">random_split</span>(person1, person2)</span>
<span id="cb59-231"><a href="#cb59-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-232"><a href="#cb59-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-233"><a href="#cb59-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-234"><a href="#cb59-234" aria-hidden="true" tabindex="-1"></a>I have run into several problems and started solving them in the editor. I think its better if I describe some procesess I have been doing though. So I still get decimals in the gaussian distribution, which I dont want. So Ill change that.</span>
<span id="cb59-235"><a href="#cb59-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-238"><a href="#cb59-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-239"><a href="#cb59-239" aria-hidden="true" tabindex="-1"></a>round_population <span class="ot">&lt;-</span> <span class="fu">round</span>(population)</span>
<span id="cb59-240"><a href="#cb59-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-241"><a href="#cb59-241" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(round_population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Random Gaussian Distribution"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb59-242"><a href="#cb59-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-243"><a href="#cb59-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-244"><a href="#cb59-244" aria-hidden="true" tabindex="-1"></a>Again, some shenanigangs.</span>
<span id="cb59-245"><a href="#cb59-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-248"><a href="#cb59-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-249"><a href="#cb59-249" aria-hidden="true" tabindex="-1"></a>person1</span>
<span id="cb59-250"><a href="#cb59-250" aria-hidden="true" tabindex="-1"></a>person2</span>
<span id="cb59-251"><a href="#cb59-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-252"><a href="#cb59-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-255"><a href="#cb59-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-256"><a href="#cb59-256" aria-hidden="true" tabindex="-1"></a>selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)</span>
<span id="cb59-257"><a href="#cb59-257" aria-hidden="true" tabindex="-1"></a><span class="co">#getting the people for trading</span></span>
<span id="cb59-258"><a href="#cb59-258" aria-hidden="true" tabindex="-1"></a>person1 <span class="ot">&lt;-</span> selected_people[<span class="dv">1</span>]</span>
<span id="cb59-259"><a href="#cb59-259" aria-hidden="true" tabindex="-1"></a>person2 <span class="ot">&lt;-</span> selected_people[<span class="dv">2</span>]</span>
<span id="cb59-260"><a href="#cb59-260" aria-hidden="true" tabindex="-1"></a>person1</span>
<span id="cb59-261"><a href="#cb59-261" aria-hidden="true" tabindex="-1"></a>person2</span>
<span id="cb59-262"><a href="#cb59-262" aria-hidden="true" tabindex="-1"></a>    <span class="co">#getting them the amount what they traded</span></span>
<span id="cb59-263"><a href="#cb59-263" aria-hidden="true" tabindex="-1"></a>new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb59-264"><a href="#cb59-264" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Updating their money</span></span>
<span id="cb59-265"><a href="#cb59-265" aria-hidden="true" tabindex="-1"></a>round_population[round_population <span class="sc">==</span> person1] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb59-266"><a href="#cb59-266" aria-hidden="true" tabindex="-1"></a>round_population[round_population <span class="sc">==</span> person2] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb59-267"><a href="#cb59-267" aria-hidden="true" tabindex="-1"></a>person1</span>
<span id="cb59-268"><a href="#cb59-268" aria-hidden="true" tabindex="-1"></a>person2</span>
<span id="cb59-269"><a href="#cb59-269" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Record the current state of the population</span></span>
<span id="cb59-270"><a href="#cb59-270" aria-hidden="true" tabindex="-1"></a>    <span class="co">#history[[t+1]] &lt;- round_population</span></span>
<span id="cb59-271"><a href="#cb59-271" aria-hidden="true" tabindex="-1"></a>  <span class="co">#}</span></span>
<span id="cb59-272"><a href="#cb59-272" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-273"><a href="#cb59-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-274"><a href="#cb59-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-275"><a href="#cb59-275" aria-hidden="true" tabindex="-1"></a><span class="co">#simulate(round_population, repetitions)</span></span>
<span id="cb59-276"><a href="#cb59-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-277"><a href="#cb59-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-278"><a href="#cb59-278" aria-hidden="true" tabindex="-1"></a>all in one thing:</span>
<span id="cb59-279"><a href="#cb59-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-282"><a href="#cb59-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb59-283"><a href="#cb59-283" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># Population.</span></span>
<span id="cb59-284"><a href="#cb59-284" aria-hidden="true" tabindex="-1"></a>MU <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Mean of the Population</span></span>
<span id="cb59-285"><a href="#cb59-285" aria-hidden="true" tabindex="-1"></a>std_dev <span class="ot">&lt;-</span> MU<span class="sc">/</span><span class="dv">5</span> <span class="co"># Standard deviation</span></span>
<span id="cb59-286"><a href="#cb59-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-287"><a href="#cb59-287" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="at">mean =</span> MU, <span class="at">sd =</span> std_dev)</span>
<span id="cb59-288"><a href="#cb59-288" aria-hidden="true" tabindex="-1"></a>round_population <span class="ot">&lt;-</span> <span class="fu">round</span>(population)</span>
<span id="cb59-289"><a href="#cb59-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-290"><a href="#cb59-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-291"><a href="#cb59-291" aria-hidden="true" tabindex="-1"></a>anyone <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population){</span>
<span id="cb59-292"><a href="#cb59-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(round_population), <span class="dv">2</span>)</span>
<span id="cb59-293"><a href="#cb59-293" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-294"><a href="#cb59-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-295"><a href="#cb59-295" aria-hidden="true" tabindex="-1"></a>random_split <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb59-296"><a href="#cb59-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum them up</span></span>
<span id="cb59-297"><a href="#cb59-297" aria-hidden="true" tabindex="-1"></a>  pot <span class="ot">&lt;-</span> x<span class="sc">+</span>y</span>
<span id="cb59-298"><a href="#cb59-298" aria-hidden="true" tabindex="-1"></a>  <span class="co">#how to share</span></span>
<span id="cb59-299"><a href="#cb59-299" aria-hidden="true" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>pot, <span class="dv">1</span>)</span>
<span id="cb59-300"><a href="#cb59-300" aria-hidden="true" tabindex="-1"></a>  <span class="co">#calcutlating the  split </span></span>
<span id="cb59-301"><a href="#cb59-301" aria-hidden="true" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> pot <span class="sc">-</span> part1</span>
<span id="cb59-302"><a href="#cb59-302" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the Gini coefficient</span></span>
<span id="cb59-303"><a href="#cb59-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(part1, part2))</span>
<span id="cb59-304"><a href="#cb59-304" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-305"><a href="#cb59-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-306"><a href="#cb59-306" aria-hidden="true" tabindex="-1"></a>simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(round_population,repetitions) {</span>
<span id="cb59-307"><a href="#cb59-307" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>repetitions) {</span>
<span id="cb59-308"><a href="#cb59-308" aria-hidden="true" tabindex="-1"></a>      selected_people <span class="ot">&lt;-</span> <span class="fu">anyone</span>(round_population)</span>
<span id="cb59-309"><a href="#cb59-309" aria-hidden="true" tabindex="-1"></a>      <span class="co">#getting the people for trading</span></span>
<span id="cb59-310"><a href="#cb59-310" aria-hidden="true" tabindex="-1"></a>      person1 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">1</span>]]</span>
<span id="cb59-311"><a href="#cb59-311" aria-hidden="true" tabindex="-1"></a>      person2 <span class="ot">&lt;-</span> round_population[selected_people[<span class="dv">2</span>]]</span>
<span id="cb59-312"><a href="#cb59-312" aria-hidden="true" tabindex="-1"></a>      <span class="co">#making the new wealth distribution between those two</span></span>
<span id="cb59-313"><a href="#cb59-313" aria-hidden="true" tabindex="-1"></a>      new_wealth <span class="ot">&lt;-</span> <span class="fu">random_split</span>(person1, person2)</span>
<span id="cb59-314"><a href="#cb59-314" aria-hidden="true" tabindex="-1"></a>      <span class="co">#overwriting the old bank statement with the new one</span></span>
<span id="cb59-315"><a href="#cb59-315" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">1</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">1</span>]</span>
<span id="cb59-316"><a href="#cb59-316" aria-hidden="true" tabindex="-1"></a>      round_population[selected_people[<span class="dv">2</span>]] <span class="ot">&lt;-</span> new_wealth[<span class="dv">2</span>]</span>
<span id="cb59-317"><a href="#cb59-317" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb59-318"><a href="#cb59-318" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb59-319"><a href="#cb59-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(round_population)</span>
<span id="cb59-320"><a href="#cb59-320" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-321"><a href="#cb59-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-322"><a href="#cb59-322" aria-hidden="true" tabindex="-1"></a>repetitions <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb59-323"><a href="#cb59-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-324"><a href="#cb59-324" aria-hidden="true" tabindex="-1"></a>final_population <span class="ot">&lt;-</span> <span class="fu">simulation</span>(round_population, repetitions)</span>
<span id="cb59-325"><a href="#cb59-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-326"><a href="#cb59-326" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(final_population, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"After Simulation Grapn"</span>, <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"skyblue"</span>)</span>
<span id="cb59-327"><a href="#cb59-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-328"><a href="#cb59-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb59-329"><a href="#cb59-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-330"><a href="#cb59-330" aria-hidden="true" tabindex="-1"></a>This IS CORRECT I WANT TO SCREAM OH MY GOD I CHANGED SO MUCH AND NOW I GET IT YAAAs.</span>
<span id="cb59-331"><a href="#cb59-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-332"><a href="#cb59-332" aria-hidden="true" tabindex="-1"></a>I also noticed that only starting at like 10'000 simulations we get this distribution, before that we dont. (Maybe Ill implement this in this website we will see)</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>